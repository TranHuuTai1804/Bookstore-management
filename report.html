<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Monthly</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abel&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/home.css">
    <style>
        /* Style cho toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.5s ease;
            visibility: hidden;
            z-index: 10001;
        }

        .toast.show {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="navbar">
            <div class="navbar-left">
                <a href="/home"><img src="/img/logo.svg" alt=""></a>
                <ul>
                    <li><a href="/home">Home</a></li>
                    <li><a href="#">About us</a></li>
                    <li><a href="#">Staff</a></li>
                </ul>
            </div>

            <div class="navbar-right">
                <button class="logout"><a href="/">Log Out</a></button>
            </div>
        </div>
    </header>

    <!-- Block Book Entry Form -->
    <div class="book-entry-form">
        <h2>Book Entry Form</h2>
    </div>

    <div class="rp-title">
        <button class="title-btn active" id="enventory-btn" onclick="showTable('enventory')">enventory Report</button>
        <button class="title-btn" id="debt-btn" onclick="showTable('debt')">Debt Report</button>
    </div>

    <!-- Tiêu đề Date -->
    <div class="date">
        <h3>Date report:</h3>
        <div class="date-picker">
            <input type="text" id="date-receipt" placeholder="Select Date" readonly>
            <img src="/img/calendar.svg" alt="Calendar Icon" id="calendar-icon">
        </div>
    </div>

    <!-- Bảng -->
   <!-- enventory Table -->
<div class="date-section" id="enventory-table">
    <table class="table-container">
        <thead>
            <tr>
                <th>No.</th>
                <th>Book</th>
                <th>First Existence</th>
                <th>Arise</th>
                <th>Last Existence</th>
            </tr>
        </thead>
        <tbody id="table-body">
            <tr>
                <td><input type="text" name="no1" placeholder="1"></td>
                <td><input type="text" name="book1" placeholder="Book Name"></td>
                <td><input type="text" name="first-Existence1" placeholder="First Existence"></td>
                <td><input type="text" name="arise1" placeholder="Arise"></td>
                <td><input type="text" name="last-Existence1" placeholder="Last Existence"></td>
            </tr>
        </tbody>
    </table>
    <button class="add-row-btn" onclick="addRow()">+</button>
</div>

<!-- Debt Table -->
<div class="date-section" id="debt-table" style="display: none;">
    <table class="table-container">
        <thead>
            <tr>
                <th>No.</th>
                <th>Guest Name</th>
                <th>First Debt</th>
                <th>Arise</th>
                <th>Last Debt</th>
            </tr>
        </thead>
        <tbody id="table-body-debt">
            <tr>
                <td><input type="text" name="no1" placeholder="1"></td>
                <td><input type="text" name="guest1" placeholder="Guest Name"></td>
                <td><input type="text" name="first-debt1" placeholder="First Debt"></td>
                <td><input type="text" name="arise1" placeholder="Arise"></td>
                <td><input type="text" name="last-debt1" placeholder="Last Debt"></td>
            </tr>
        </tbody>
    </table>
    <button class="add-row-btn" onclick="addRow()">+</button>
</div>
    <button class="done-btn" onclick="submitBooks()">Done</button>

    <button class="open-menu" onclick="toggleMenu()">></button>

    <!-- Overlay -->
    <div id="overlay" class="overlay"></div>

    <!-- Menu Section -->
    <div id="hero-menu" class="menu-ovl" style="display: none;">
        <button><a href="/bookempty">Book Entry Form</a></button>
        <button><a href="/bookinvoice">Book Invoice</a></button>
        <button><a href="lookup">Book Lookup</a></button>
        <button><a href="/receipts">Receipt</a></button>
        <button><a href="/report">Monthly Report</a></button>
        <button><a href="/edit">Edit Regulations</a></button>
    </div>

    <!-- Toast thông báo -->
    <div id="toast" class="toast">Books added successfully!</div>

</body>
    <script>

            function showTable(type) {
                const enventoryBtn = document.getElementById('enventory-btn');
                const debtBtn = document.getElementById('debt-btn');
                const enventoryTable = document.getElementById('enventory-table');
                const debtTable = document.getElementById('debt-table');

                if (type === 'enventory') {
                    // Đổi trạng thái nút
                    enventoryBtn.classList.add('active');
                    debtBtn.classList.remove('active');

                    // Hiển thị bảng enventory
                    enventoryTable.style.display = 'block';
                    debtTable.style.display = 'none';
                } else if (type === 'debt') {
                    // Đổi trạng thái nút
                    debtBtn.classList.add('active');
                    enventoryBtn.classList.remove('active');

                    // Hiển thị bảng Debt
                    debtTable.style.display = 'block';
                    enventoryTable.style.display = 'none';
                }
            }

                // Lấy thẻ input ngày
                const dateInput = document.getElementById("date-receipt");

                // Hàm để lấy ngày hiện tại theo định dạng YYYY-MM-DD
                function getCurrentDate() {
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, "0"); // Tháng bắt đầu từ 0
                const day = String(today.getDate()).padStart(2, "0");
                return `${year}-${month}-${day}`;
                }

                // Gán ngày hiện tại vào thẻ input khi trang được tải lên
                dateInput.value = getCurrentDate();

                // Cập nhật ngày khi người dùng nhấp vào thẻ input
                dateInput.addEventListener("focus", function () {
                dateInput.value = getCurrentDate(); // Gán lại ngày hiện tại nếu có thay đổi
                });

                function toggleMenu() {
                    const menu = document.getElementById("hero-menu");
                    const overlay = document.getElementById("overlay");
                    const icon = document.querySelector(".open-menu");
                    const body = document.body;

                    // Kiểm tra nếu menu đang ẩn
                    if (menu.style.display === "none" || menu.style.display === "") {
                        menu.style.display = "block"; // Mở menu
                        setTimeout(() => {
                            menu.style.left = "0"; // Đặt menu vào vị trí mong muốn với hiệu ứng trượt
                        }, 10); // Đảm bảo hiệu ứng trượt được áp dụng
                        overlay.style.display = "block"; // Hiện overlay
                        icon.textContent = "<"; // Đổi icon thành '<'

                        // Thêm lớp menu-open để di chuyển icon
                        body.classList.add("menu-open");
                    } else {
                        menu.style.left = "-30%"; // Ẩn menu với hiệu ứng trượt
                        overlay.style.display = "none"; // Ẩn overlay
                        icon.textContent = ">"; // Đổi icon thành '>'

                        // Loại bỏ lớp menu-open để di chuyển icon về vị trí ban đầu
                        body.classList.remove("menu-open");

                        setTimeout(() => {
                            menu.style.display = "none"; // Ẩn menu sau khi trượt hoàn tất
                        }, 300); // Thời gian trượt hoàn tất trước khi ẩn menu
                    }
                }

                // Ẩn thanh cuộn khi người dùng lướt lên hoặc xuống
                const menuOv = document.getElementById("hero-menu");

                menuOv.addEventListener('scroll', function() {
                    menuOv.style.scrollbarWidth = 'none'; // Ẩn thanh cuộn khi lướt
                    clearTimeout(menuOv.scrollTimeout);
                    
                    menuOv.scrollTimeout = setTimeout(function() {
                        menuOv.style.scrollbarWidth = 'thin'; // Hiển thị lại thanh cuộn khi ngừng lướt
                    }, 100); // Ẩn thanh cuộn khi lướt và hiển thị lại sau khi ngừng
                });

                    // Hàm thêm dòng mới vào bảng
                    function addRow() {
                        // Kiểm tra bảng đang hiển thị
                        const enventoryTable = document.getElementById("enventory-table");
                        const debtTable = document.getElementById("debt-table");

                        if (enventoryTable.style.display === "block") {
                            // Thêm dòng mới vào bảng enventory
                            const tableBody = document.getElementById("table-body");
                            const newRow = document.createElement("tr");

                            newRow.innerHTML = `
                                <td><input type="text" placeholder="No."></td>
                                <td><input type="text" placeholder="Book Name"></td>
                                <td><input type="text" placeholder="First Existence"></td>
                                <td><input type="text" placeholder="Arise"></td>
                                <td><input type="text" placeholder="Last Existence"></td>
                            `;
                            tableBody.appendChild(newRow);
                        } else if (debtTable.style.display === "block") {
                            // Thêm dòng mới vào bảng debt
                            const tableBodyDebt = document.getElementById("table-body-debt");
                            const newRow = document.createElement("tr");

                            newRow.innerHTML = `
                                <td><input type="text" placeholder="No."></td>
                                <td><input type="text" placeholder="Guest Name"></td>
                                <td><input type="text" placeholder="First Debt"></td>
                                <td><input type="text" placeholder="Arise"></td>
                                <td><input type="text" placeholder="Last Debt"></td>
                            `;
                            tableBodyDebt.appendChild(newRow);
                        }
                    }
                    // Hàm xử lý khi nhấn nút Done
                    function submitBooks() {
                        // Kiểm tra bảng đang hiển thị
                        const enventoryTable = document.getElementById("enventory-table");
                        const debtTable = document.getElementById("debt-table");

                        if (enventoryTable.style.display === "block") {
                            // Xử lý dữ liệu cho bảng enventory
                            const rows = document.querySelectorAll("#table-body tr");
                            const books = [];

                            rows.forEach((row) => {
                                const cells = row.querySelectorAll("input");
                                const bookData = {
                                    no: cells[0].value,
                                    bookName: cells[1].value,
                                    firstExistence: cells[2].value,
                                    arise: cells[3].value,
                                    lastExistence: cells[4].value,
                                };
                                books.push(bookData);
                            });

                            console.log("Enventory Report:", books);
                        } else if (debtTable.style.display === "block") {
                            // Xử lý dữ liệu cho bảng debt
                            const rows = document.querySelectorAll("#table-body-debt tr");
                            const debts = [];

                            rows.forEach((row) => {
                                const cells = row.querySelectorAll("input");
                                const debtData = {
                                    no: cells[0].value,
                                    guestName: cells[1].value,
                                    firstDebt: cells[2].value,
                                    arise: cells[3].value,
                                    lastDebt: cells[4].value,
                                };
                                debts.push(debtData);
                            });

                            console.log("Debt Report:", debts);
                        }

                        // Hiển thị toast thông báo
                        showToast();

                        // Làm mới bảng sau khi nhấn Done (áp dụng cho cả hai bảng)
                        if (enventoryTable.style.display === "block") {
                            document.getElementById("table-body").innerHTML = `
                                <tr>
                                    <td><input type="text" placeholder="No."></td>
                                    <td><input type="text" placeholder="Book Name"></td>
                                    <td><input type="text" placeholder="First Existence"></td>
                                    <td><input type="text" placeholder="Arise"></td>
                                    <td><input type="text" placeholder="Last Existence"></td>
                                </tr>
                            `;
                        } else if (debtTable.style.display === "block") {
                            document.getElementById("table-body-debt").innerHTML = `
                                <tr>
                                    <td><input type="text" placeholder="No."></td>
                                    <td><input type="text" placeholder="Guest Name"></td>
                                    <td><input type="text" placeholder="First Debt"></td>
                                    <td><input type="text" placeholder="Arise"></td>
                                    <td><input type="text" placeholder="Last Debt"></td>
                                </tr>
                            `;
                        }
                    }

                    // Hàm hiển thị toast
                    function showToast() {
                    const toast = document.getElementById("toast");
                    toast.classList.add("show");

                    // Ẩn toast sau 3 giây
                    setTimeout(() => {
                        toast.classList.remove("show");
                    }, 3000);
                    }

    </script>
</html>
